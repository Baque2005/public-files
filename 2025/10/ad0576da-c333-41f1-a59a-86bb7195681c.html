<!DOCTYPE html>
<html>
<head>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        body {
            background: #1a0b1f;
            margin: 0;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            position: relative;
            font-family: 'Arial', sans-serif;
        }
        #estrellas, #explosion, #canvas-letras {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 5;
        }
        #gif-izq, #gif-der {
            position: absolute;
            bottom: 2vw;
            width: 22vw;
            max-width: 160px;
            min-width: 80px;
            z-index: 10;
        }
        #gif-izq { left: 2vw; }
        #gif-der { right: 2vw; }

        @media (max-width: 600px) {
            #gif-izq, #gif-der { width: 32vw; max-width: 90px; min-width: 50px; }
        }

        .corazon-volador {
            position: fixed;
            pointer-events: none;
            z-index: 99;
            will-change: transform, opacity;
            animation: corazonVuelo var(--duracion) linear forwards;
            left: var(--x0);
            top: var(--y0);
            font-size: var(--tamano);
        }
        @keyframes corazonVuelo {
            0%   { opacity: 1; transform: translate(0,0) scale(0.8) rotate(0deg);}
            60%  { opacity: 1; }
            100% { opacity: 0; transform: translate(var(--dx),var(--dy)) scale(1.5) rotate(720deg);}
        }

        #globo {
            position: absolute;
            top: -300px;
            left: 50%;
            transform: translateX(-50%);
            width: 180px;
            z-index: 15;
            transition: top 1s ease, left 1s ease;
        }

        #canvas-letras {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 5;
        }

        #boton-poema {
            display: none;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 30px;
            font-size: 22px;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #ff6b8b, #ffb3c1);
            border: none;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 107, 139, 0.6);
            z-index: 20;
            transition: transform 0.2s;
        }
        #boton-poema:hover { transform: translateX(-50%) scale(1.1); }

        #poema {
            display: none;
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translateX(-50%);
            color: #ffb3c1;
            font-family: 'Dancing Script', cursive;
            font-size: 32px;
            text-align: center;
            line-height: 1.5;
            z-index: 15;
            white-space: pre-wrap;
            overflow: hidden;
            border-right: 2px solid #ffb3c1;
            min-width: 2ch;
        }
        @keyframes parpadeo {
            from, to { border-color: transparent; }
            50% { border-color: #ffb3c1; }
        }

        #mensaje-bonito {
            display: none;
            position: absolute;
            top: 7vh;
            left: 50%;
            transform: translateX(-50%);
            color: #ffb3c1;
            font-family: 'Dancing Script', cursive;
            font-size: 2.5em;
            font-weight: bold;
            text-align: center;
            z-index: 50;
            text-shadow: 0 0 18px #ff6b8b, 0 0 8px #fff;
            letter-spacing: 0.04em;
            opacity: 0;
            transition: opacity 1.2s;
        }
        
        /* Nuevos estilos para el mensaje especial */
        #mensaje-especial {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 700px;
            background: rgba(26, 11, 31, 0.85);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 0 30px rgba(255, 107, 139, 0.5);
            border: 2px solid #ff6b8b;
            z-index: 25;
            color: #ffb3c1;
            font-family: 'Dancing Script', cursive;
            font-size: 1.8em;
            line-height: 1.6;
            text-align: center;
            backdrop-filter: blur(5px);
            opacity: 0;
            transition: opacity 1.5s ease;
        }
        
        #mensaje-especial.visible {
            opacity: 1;
            animation: pulseMessage 3s infinite alternate;
        }
        
        @keyframes pulseMessage {
            0% { box-shadow: 0 0 20px rgba(255, 107, 139, 0.5); }
            100% { box-shadow: 0 0 40px rgba(255, 107, 139, 0.8); }
        }
        
        #cerrar-mensaje {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: #ffb3c1;
            font-size: 24px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        #cerrar-mensaje:hover {
            transform: scale(1.2);
        }
        
        #boton-mensaje-especial {
            display: none;
            position: absolute;
            left: 50%;
            bottom: 15vh;
            transform: translateX(-50%);
            padding: 12px 25px;
            font-size: 18px;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #5dade2, #3498db);
            border: none;
            border-radius: 20px;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(93, 173, 226, 0.6);
            z-index: 20;
            transition: transform 0.2s;
        }
        
        #boton-mensaje-especial:hover {
            transform: translateX(-50%) scale(1.1);
        }
        
        .flor {
            position: absolute;
            font-size: 24px;
            z-index: 8;
            opacity: 0.7;
            animation: flotar 8s infinite linear;
        }
        
        @keyframes flotar {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.7; }
            90% { opacity: 0.5; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }
        
        #control-audio {
            position: absolute;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(255, 107, 139, 0.7);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            color: white;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255, 107, 139, 0.5);
            transition: transform 0.3s;
        }
        
        #control-audio:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <canvas id="estrellas"></canvas>
    <canvas id="explosion"></canvas>
    <canvas id="canvas-letras"></canvas>
    <img id="globo" src="https://i.pinimg.com/originals/af/00/01/af00017fd37a0caeb9f10a37369082c9.gif">
    <img id="gif-izq" src="https://i.pinimg.com/originals/25/d8/20/25d820ca673d1259d5dcce85b87f3bb7.gif">
    <img id="gif-der" src="https://i.pinimg.com/originals/27/1f/34/271f342c91e187bfc5e2ff4a8b977211.gif">
    <div id="te-amo-superior">TE AMO</div>
    <button id="boton-poema">Presiona</button>
    <button id="boton-mensaje-especial">Mensaje Especial</button>
    <div id="mensaje-bonito">Eres mi causa m√°s bonita</div>
    <div id="poema"></div>
    
    <div id="mensaje-especial">
        <button id="cerrar-mensaje">√ó</button>
        Que sepas yo te amo con todo mi coraz√≥n y que por eso te dedico mayor parte de mi tiempo y quisiera que t√∫ fueras con la personita que quisiera pasar el resto de mi vida y te har√© feliz todo lo que quieres pero antes de todo quisiera conocerte mucho mejor de lo que te conozco y que me dieras una oportunidad para ser el amor de tu vida üíù
    </div>
    
    <button id="control-audio">‚ô™</button>
    
    <audio id="audio-fondo" loop>
        <source src="https://s21.aconvert.com/convert/p3r68-cdx67/sqdmi-7gear.mp3" type="audio/mp3">
    </audio>

    <script>
        // Corazones entre gifs (menos cantidad y m√°s optimizado)
        function dispararCorazon(){
            const rectIzq=document.getElementById('gif-izq').getBoundingClientRect();
            const rectDer=document.getElementById('gif-der').getBoundingClientRect();
            for(let i=0;i<2;i++){ // solo 2 corazones por ciclo
                setTimeout(()=>{
                    const corazon=document.createElement('div');
                    corazon.className='corazon-volador';
                    corazon.innerHTML='‚ô•';
                    corazon.style.color='hsl('+(Math.random()*30+330)+',80%,75%)';
                    const x0 = rectIzq.left + rectIzq.width/2 + Math.random()*20-10;
                    const y0 = rectIzq.top + rectIzq.height/2 + Math.random()*20-10;
                    corazon.style.setProperty('--x0', x0 + 'px');
                    corazon.style.setProperty('--y0', y0 + 'px');
                    const dx = rectDer.left + rectDer.width/2 + Math.random()*20-10 - x0;
                    const dy = rectDer.top + rectDer.height/2 + Math.random()*20-10 - y0;
                    corazon.style.setProperty('--dx', dx + 'px');
                    corazon.style.setProperty('--dy', dy + 'px');
                    corazon.style.setProperty('--tamano', `${Math.random()*1+2}em`);
                    corazon.style.setProperty('--duracion', '1s');
                    document.body.appendChild(corazon);
                    setTimeout(()=>corazon.remove(), 1200);
                }, i*100);
            }
        }
        setInterval(dispararCorazon, 400);

        // === Fondo estrellado interactivo optimizado ===
        // Reduce la cantidad de estrellas y simplifica el renderizado
        let mouse = { x: -1000, y: -1000, clicked: false };
        const canvasEstrellas = document.getElementById('estrellas');
        const ctxE = canvasEstrellas.getContext('2d');
        let w=window.innerWidth, h=window.innerHeight;
        canvasEstrellas.width=w; canvasEstrellas.height=h;

        let estrellas=[];
        for(let i=0;i<70;i++){ // menos estrellas para m√°s fluidez
            estrellas.push({x:Math.random()*w,y:Math.random()*h,r:Math.random()*1.5+.5,a:Math.random()*Math.PI*2,v:Math.random()*.02+.01,dx:Math.random()*0.09+0.02,dy:Math.random()*0.09+0.02,vx:0,vy:0});
        }

        function dibujarEstrellas(){
            ctxE.clearRect(0,0,w,h);
            for(let e of estrellas){
                let dist=Math.hypot(e.x-mouse.x,e.y-mouse.y);
                if(dist<80){let ang=Math.atan2(mouse.y-e.y,mouse.x-e.x); e.vx+=Math.cos(ang)*0.12; e.vy+=Math.sin(ang)*0.12;}
                if(mouse.clicked && dist<110){let ang=Math.atan2(e.y-mouse.y,e.x-mouse.x); e.vx+=Math.cos(ang)*0.7; e.vy+=Math.sin(ang)*0.7;}
                e.vx*=0.92; e.vy*=0.92; e.x+=e.dx+e.vx; e.y+=e.dy+e.vy; e.a+=e.v;
                if(e.x>w)e.x=0; if(e.x<0)e.x=w; if(e.y>h)e.y=0; if(e.y<0)e.y=h;
                let b=Math.abs(Math.sin(e.a))*.7+.3;
                ctxE.beginPath(); ctxE.arc(e.x,e.y,e.r,0,Math.PI*2);
                ctxE.fillStyle=`rgba(255,255,255,${b})`;
                ctxE.shadowColor="#fff"; ctxE.shadowBlur=4*b; ctxE.fill();
            }
            requestAnimationFrame(dibujarEstrellas);
        }
        dibujarEstrellas();
        window.addEventListener('resize',()=>{
            w=window.innerWidth;h=window.innerHeight;
            canvasEstrellas.width=w;canvasEstrellas.height=h;
        });
        canvasEstrellas.addEventListener('mousemove',e=>{mouse.x=e.clientX; mouse.y=e.clientY;});
        canvasEstrellas.addEventListener('mouseleave',()=>{mouse.x=-1000; mouse.y=-1000;});
        canvasEstrellas.addEventListener('mousedown',()=>{mouse.clicked=true; setTimeout(()=>{mouse.clicked=false;},150);});

        // === Corazones entre gifs (uno seguido del otro, no en r√°fagas) ===
        function dispararCorazon(){
            const rectIzq=document.getElementById('gif-izq').getBoundingClientRect();
            const rectDer=document.getElementById('gif-der').getBoundingClientRect();
            const corazon=document.createElement('div');
            corazon.className='corazon-volador';
            corazon.innerHTML='‚ô•';
            corazon.style.color='hsl('+(Math.random()*30+330)+',80%,75%)';
            const x0 = rectIzq.left + rectIzq.width/2 + Math.random()*30-15;
            const y0 = rectIzq.top + rectIzq.height/2 + Math.random()*30-15;
            corazon.style.setProperty('--x0', x0 + 'px');
            corazon.style.setProperty('--y0', y0 + 'px');
            const dx = rectDer.left + rectDer.width/2 + Math.random()*30-15 - x0;
            const dy = rectDer.top + rectDer.height/2 + Math.random()*30-15 - y0;
            corazon.style.setProperty('--dx', dx + 'px');
            corazon.style.setProperty('--dy', dy + 'px');
            corazon.style.setProperty('--tamano', `${Math.random()*1.2+2.2}em`);
            corazon.style.setProperty('--duracion', '1.1s');
            document.body.appendChild(corazon);
            setTimeout(()=>corazon.remove(), 1300);
        }
        setInterval(dispararCorazon, 180);

        // === Letras TE AMO con part√≠culas (siempre visible, nunca se borra el canvas-letras ni se oculta el globo) ===
        const canvasLetras=document.getElementById('canvas-letras');
        const ctxL=canvasLetras.getContext('2d');
        canvasLetras.width=window.innerWidth; canvasLetras.height=window.innerHeight;
        let letrasDibujadas=[];
        function dibujarCorazon(x,y,size,color="red"){
            ctxL.save();
            ctxL.translate(x,y);
            ctxL.scale(size/20,size/20);
            ctxL.beginPath();
            ctxL.moveTo(0,-10);
            ctxL.bezierCurveTo(10,-20,25,0,0,20);
            ctxL.bezierCurveTo(-25,0,-10,-20,0,-10);
            ctxL.fillStyle=color;
            ctxL.shadowColor="#ff4d6d"; ctxL.shadowBlur=5;
            ctxL.fill();
            ctxL.restore();
        }
        function crearLetra(letra,offsetX){
            let tempCanvas=document.createElement("canvas");
            tempCanvas.width=canvasLetras.width; tempCanvas.height=canvasLetras.height;
            let tempCtx=tempCanvas.getContext("2d");
            tempCtx.font="bold 160px Arial";
            tempCtx.textAlign="center";
            tempCtx.fillText(letra,canvasLetras.width/2+offsetX,canvasLetras.height/2);
            let imageData=tempCtx.getImageData(0,0,tempCanvas.width,tempCanvas.height);
            let puntos=[];
            for(let y=0;y<imageData.height;y+=10){
                for(let x=0;x<imageData.width;x+=10){
                    let index=(y*imageData.width+x)*4;
                    if(imageData.data[index+3]>128) puntos.push({x,y});
                }
            }
            return puntos;
        }
        const texto="TE AMO";
        const espaciado=[-300,-190,0,70,180,300];
        let indice=0;
        const globo=document.getElementById('globo');
        function traerLetra(){
            if(indice>=texto.length){
                // Mostrar el bot√≥n solo cuando termina el globo y las letras
                const boton=document.getElementById('boton-poema');
                boton.style.display="block";
                // Tambi√©n mostrar el bot√≥n del mensaje especial
                document.getElementById('boton-mensaje-especial').style.display = "block";
                return;
            }
            let letra=texto[indice];
            if(letra!==" "){
                let puntos=crearLetra(letra,espaciado[indice]);
                globo.style.left=`calc(50% + ${espaciado[indice]}px)`;
                let minY=Math.min(...puntos.map(p=>p.y));
                globo.style.top=(minY-100)+"px";
                setTimeout(()=>{
                    letrasDibujadas.push(...puntos);
                    for(let p of letrasDibujadas) dibujarCorazon(p.x,p.y,8+Math.random()*6);
                    globo.style.top="-300px";
                    indice++;
                    setTimeout(traerLetra,1200);
                },1200);
            } else {indice++; setTimeout(traerLetra,300);}
        }
        setTimeout(()=>{
            globo.style.display = "block";
            traerLetra();
        },1000);

        // Explosi√≥n de part√≠culas en canvas separado, por toda la pantalla
        function explosionEstrellas() {
            const canvas = document.getElementById('explosion');
            const ctx = canvas.getContext('2d');
            canvas.width = w;
            canvas.height = h;

            // Genera muchas explosiones en posiciones aleatorias
            let centros = [];
            for(let i=0; i<8; i++){
                centros.push({
                    x: Math.random()*w*0.8 + w*0.1,
                    y: Math.random()*h*0.7 + h*0.15
                });
            }

            let particulas = [];
            for (let c = 0; c < centros.length; c++) {
                for(let i=0;i<40;i++){
                    let ang = Math.random()*2*Math.PI;
                    let vel = 2.5 + Math.random()*3.5;
                    particulas.push({
                        x: centros[c].x,
                        y: centros[c].y,
                        r: Math.random()*2+1,
                        vx: Math.cos(ang)*vel,
                        vy: Math.sin(ang)*vel,
                        alpha: 1
                    });
                }
            }
            function animar(){
                ctx.clearRect(0,0,w,h);
                let vivos = false;
                for(let p of particulas){
                    if(p.alpha > 0.05){
                        vivos = true;
                        ctx.save();
                        ctx.globalAlpha = p.alpha;
                        ctx.beginPath();
                        ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
                        ctx.fillStyle = "#fff";
                        ctx.shadowColor = "#fff";
                        ctx.shadowBlur = 12;
                        ctx.fill();
                        ctx.restore();
                        p.x += p.vx;
                        p.y += p.vy;
                        p.vx *= 0.96;
                        p.vy *= 0.96;
                        p.alpha *= 0.96;
                    }
                }
                if(vivos) requestAnimationFrame(animar);
            }
            animar();
        }

        // Al presionar el bot√≥n: muestra mensaje bonito y lanza explosiones peri√≥dicas, pero NO oculta el TE AMO de part√≠culas ni el globo
        const boton=document.getElementById('boton-poema');
        boton.addEventListener('click',()=>{
            boton.style.display="none";
            // NO borrar canvas-letras ni ocultar globo
            // Muestra mensaje bonito arriba
            const mensaje=document.getElementById('mensaje-bonito');
            mensaje.style.display = "block";
            setTimeout(()=>{ mensaje.style.opacity = 1; }, 50);

            // Explosi√≥n de part√≠culas por toda la pantalla cada 2 segundos
            explosionEstrellas();
            setInterval(explosionEstrellas, 2000);
        });
        
        // Funcionalidad para el mensaje especial
        const botonMensajeEspecial = document.getElementById('boton-mensaje-especial');
        const mensajeEspecial = document.getElementById('mensaje-especial');
        const cerrarMensaje = document.getElementById('cerrar-mensaje');
        
        botonMensajeEspecial.addEventListener('click', () => {
            mensajeEspecial.style.display = 'block';
            setTimeout(() => {
                mensajeEspecial.classList.add('visible');
            }, 10);
            
            // Lanzar corazones especiales
            for(let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const corazon = document.createElement('div');
                    corazon.className = 'corazon-volador';
                    corazon.innerHTML = 'üíù';
                    corazon.style.color = 'hsl('+(Math.random()*30+330)+',80%,75%)';
                    const x0 = Math.random() * window.innerWidth;
                    const y0 = window.innerHeight + 50;
                    corazon.style.setProperty('--x0', x0 + 'px');
                    corazon.style.setProperty('--y0', y0 + 'px');
                    const dx = (Math.random() - 0.5) * 200;
                    const dy = -window.innerHeight - 100;
                    corazon.style.setProperty('--dx', dx + 'px');
                    corazon.style.setProperty('--dy', dy + 'px');
                    corazon.style.setProperty('--tamano', `${Math.random()*2+3}em`);
                    corazon.style.setProperty('--duracion', '4s');
                    document.body.appendChild(corazon);
                    setTimeout(() => corazon.remove(), 4000);
                }, i * 200);
            }
        });
        
        cerrarMensaje.addEventListener('click', () => {
            mensajeEspecial.classList.remove('visible');
            setTimeout(() => {
                mensajeEspecial.style.display = 'none';
            }, 500);
        });
        
        // Funcionalidad para el audio
        const audio = document.getElementById('audio-fondo');
        const controlAudio = document.getElementById('control-audio');
        let audioReproduciendo = false;
        
        controlAudio.addEventListener('click', () => {
            if (audioReproduciendo) {
                audio.pause();
                controlAudio.textContent = '‚ô™';
            } else {
                audio.play();
                controlAudio.textContent = '‚ñÆ‚ñÆ';
            }
            audioReproduciendo = !audioReproduciendo;
        });
        
        // A√±adir flores decorativas
        function crearFlores() {
            const flores = ['üåπ', 'üå∏', 'üå∫', 'üå∑', 'üíê', 'üåª'];
            for (let i = 0; i < 15; i++) {
                const flor = document.createElement('div');
                flor.className = 'flor';
                flor.textContent = flores[Math.floor(Math.random() * flores.length)];
                flor.style.left = Math.random() * 100 + 'vw';
                flor.style.fontSize = (Math.random() * 20 + 15) + 'px';
                flor.style.animationDelay = (Math.random() * 20) + 's';
                flor.style.animationDuration = (8 + Math.random() * 12) + 's';
                document.body.appendChild(flor);
            }
        }
        
        // Iniciar todo cuando la p√°gina cargue
        window.addEventListener('load', () => {
            crearFlores();
            
            // Reproducir audio autom√°ticamente (con interacci√≥n del usuario requerida en algunos navegadores)
            controlAudio.click();
        });
    </script>
</body>
</html>